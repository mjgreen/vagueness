Show how mean times for individual subjects and items vary with respect to the grand mean RT_RecSqt.

```{r, fig.width=10, fig.height=5}
# Show how mean times for individual subjects and items vary with respect to the grand mean RT_RecSqt.

suppressMessages(library(plyr))
suppressMessages(library(lattice))
suppressMessages(library(latticeExtra))

subs <- ddply(dd, .(level=Subject), summarise, 
              effect="subject", emean=mean(dd$RT_RecSqt), lmean=mean(RT_RecSqt), ldiff=mean(RT_RecSqt)-mean(dd$RT_RecSqt),
              lsign=ifelse(mean(RT_RecSqt)-mean(dd$RT_RecSqt)<0,"slow","fast"))
itms <- ddply(dd, .(level=Item), summarise, effect="item", emean=mean(dd$RT_RecSqt), lmean=mean(RT_RecSqt),
              ldiff=mean(RT_RecSqt)-mean(dd$RT_RecSqt), lsign=ifelse(mean(RT_RecSqt)-mean(dd$RT_RecSqt)<0,"slow","fast"))
si <- rbind(subs,itms)
si$effect <- factor(si$effect, levels=c("subject", "item"))
si$lsign <- factor(si$lsign, levels=c("slow","fast"))

my1 <- xyplot(data=si, lmean~level | effect, 
              aspect=1,
              layout=c(2,1),
              ylim = extendrange(si$lmean, f = 0.10),
              par.settings = list(trellis.par.set(superpose.symbol = list(col = c("blue","red"), pch=19), superpose.line=list(col = c("blue","red")))),
              groups = si$lsign,
              xlab = NULL,
              ylab = "RT_RecSqt: reciprocal of square root of RT in ms\n",
              key=list(text=list(levels(si$lsign)), lines=list(lty=c(1,1), col=trellis.par.get('superpose.line')$col, pch=c(19,19), type='o'), divide=1),
              mean = unique(si$emean),
              scales = list(x=list(relation="free", at=list(15.5, 32.5), labels=list("subject number", "item identifier"), cex=1 ) ),
              panel=function(x,y,type,subscripts,groups=groups,...){
                panel.xyplot(x,y,type='p',groups=groups, subscripts=subscripts,...)
                panel.arrows(x0=x, y0=unique(si$emean), x1=x, y1=y, groups=groups, subscripts=subscripts, code=3, length=0, col=trellis.par.get('superpose.line')$col[groups][subscripts], ...)
                panel.abline(h=unique(si$emean), col="lightgrey",lty=1)
                panel.text(x, y=(ifelse(y<unique(si$emean),y-.001,y+.001)), as.numeric(si$level)[subscripts][panel.number()==1], cex=.75)
                panel.text(x, y=(ifelse(y<unique(si$emean),y-.001,y+.001)), as.character(si$level)[subscripts][panel.number()==2], cex=.75)
              })

my2 <- xyplot(data=si, ldiff~level | effect, 
              aspect=1, type='n',
              ylab="\nDeviation from mean RT_RecSqt (in ms)",
              ylim=extendrange(si$ldiff,f=0.10))

print(doubleYScale(my1, my2, add.axis=TRUE, add.ylab2=TRUE, use.style=FALSE))
```
